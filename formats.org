* Script: .tsc
** Encryption
   key_idx = floor(length/2)
   key = char file[key_idx]
   char decrypted[x] = char file[x] - key   if x /= key_idx
                     = char file[x]         if x = key_idx
** "#",number  means the start of the script numbered 'number'
** Commands start with <
*** TSC Commands
| AE+        | Arms Energy +       | Refill ammo                                                                                                                                             |                                                              |
| AM+x:y     | ArMs +              | Get weapon X, add Y to max ammo (just adds ammo if you have the weapon)                                                                                 |                                                              |
| AM-x       | ArMs -              | Lose weapon X                                                                                                                                           |                                                              |
| AMJx:y     | ArMs Jump           | Jump to event Y if you have weapon X                                                                                                                    |                                                              |
| ANPx:y:z   | Animate eNtity [P?] | Animate entity X with method Y in direction Z [entity type determines Y values?]                                                                        |                                                              |
| BOAx       | Boss [OA?]          | [animate boss entity?]                                                                                                                                  |                                                              |
| CLO        | CLOse               | Close the text box (used after MSG/MS2/MS3)                                                                                                             |                                                              |
| CLR        | CLeaR               | Clear the text box (used after MSG/MS2/MS3)                                                                                                             |                                                              |
| CMPx:y:z   | Change Map [P?]     | Change map coords X:Y to tile Z                                                                                                                         |                                                              |
| CMUx       | Change MUsic        | Change music to song X                                                                                                                                  |                                                              |
| CNPx:y:z   | Change eNtity [P?]  | Change entity X to entity type Y with direction Z                                                                                                       |                                                              |
| CPS        | Clear Prop. Sound   | Stop propeller sound (used after SPS) (from helicopter cutscene after final battles)                                                                    |                                                              |
| CRE        | CREdits             | Roll credits                                                                                                                                            |                                                              |
| CSS        | Clear Stream Sound  | Stop stream sound (used after SSS) (from River area)                                                                                                    |                                                              |
| DNAx       | [?]                 | [something to do with bosses]                                                                                                                           |                                                              |
| DNPx       | Delete eNtity [P?]  | Entity X is removed completely                                                                                                                          |                                                              |
| ECJx:y     | [EC?] Jump          | @ Jump to event Y if any entity with ID X is present                                                                                                    |                                                              |
| END        | END                 | End scripted event                                                                                                                                      |                                                              |
| EQ+x       | EQuip +             | Add X to equip flag bytes                                                                                                                               |                                                              |
| EQ-x       | EQuip -             | Subtract X from equip flag bytes                                                                                                                        |                                                              |
| ESC        | ESCape              | Quit to title screen                                                                                                                                    |                                                              |
| EVEx       | EVEnt               | Jump to event X (non-conditional)                                                                                                                       |                                                              |
| FACx       | FACe                | Show face X in text box                                                                                                                                 |                                                              |
| FAIx       | FAde In             | Fade in with direction X                                                                                                                                |                                                              |
| FAOx       | FAde Out            | Fade out with direction X                                                                                                                               |                                                              |
| FL+x       | FLag +              | Set flag X                                                                                                                                              |                                                              |
| FL-x       | FLag -              | Clear flag X                                                                                                                                            |                                                              |
| FLA        | FLAsh               | Flash the screen                                                                                                                                        |                                                              |
| FLJx:y     | FLag Jump           | Jump to event Y if flag X is set                                                                                                                        |                                                              |
| FMU        | Fade MUsic          | Fade the music to a low volume (good to use before CMU)                                                                                                 |                                                              |
| FOBx:y     | Focus On [Boss?]    | [Focus view on boss entity X? why not use FON?], view movement takes Y ticks                                                                            |                                                              |
| FOMx       | Focus On Me         | Focus view on you (normal view), view movement takes X ticks (WARNING: speed 0000 crashes)                                                              |                                                              |
| FONx:y     | Focus On eNtity     | Focus view on entity X, view movement takes Y ticks                                                                                                     |                                                              |
| FRE        | FREe                | Frees menu cursor [also used after ZAM for some reason?]                                                                                                |                                                              |
| GITx       | Graphic ITem        | Show weapon/item X icon above text box - add 1000 to X for items - GIT0000 to hide                                                                      |                                                              |
| HMC        | Hide My Character   | Removes main character entity (use SMC after)                                                                                                           |                                                              |
| INI        | INItialize          | Resets memory and starts game from the beginning                                                                                                        |                                                              |
| INPx:y:z   | [I?] eNtity [P?]    | @                                                                                                                                                       |                                                              |
| IT+x       | ITem +              | Get item X                                                                                                                                              |                                                              |
| IT-x       | ITem -              | Lose item X                                                                                                                                             |                                                              |
| ITJx:y     | ITem Jump           | Jump to event Y if you have item X                                                                                                                      |                                                              |
| KEY        | KEYlock             | Hides status bars and locks out input to your character until END (used with MSG/MS2/MS3 and PRI)                                                       |                                                              |
| LDP        | LoaD Profile        | Loads profile.dat into memory and starts game from save                                                                                                 |                                                              |
| LI+x       | LIfe +              | Restore X amount of health                                                                                                                              |                                                              |
| ML+x       | Max Life +          | Max health increased X amount                                                                                                                           |                                                              |
| MLP        | Map [LP?]           | Display map [how is this used without blanking screen while map is displayed?]                                                                          |                                                              |
| MM0        | My Motion 0         | Instantly halts your horizontal motion                                                                                                                  |                                                              |
| MNA        | [Name? New Area?]   | Displays name of current map                                                                                                                            |                                                              |
| MNPx:y:z:w | Move eNtity [P?]    | Move entity X to coords Y:Z facing direction W                                                                                                          |                                                              |
| MOVx:y     | MOVe                | Move you to coords X:Y                                                                                                                                  |                                                              |
| MP+x       | [MaP ??]            | @                                                                                                                                                       |                                                              |
| MPJx       | [MaP Jump?]         | [Jump to event X if map exists for current area?]                                                                                                       |                                                              |
| MS2        | MeSsage 2           | Open invisible text box at top of screen (text follows)                                                                                                 |                                                              |
| MS3        | MeSsage 3           | Open normal text box at top of screen (text follows)                                                                                                    |                                                              |
| MSG        | MeSsaGe 1           | Open normal text box (text follows)                                                                                                                     |                                                              |
| MYBx       | MY Bump             | Knocks you back from direction X (0000 knocked right, 0002 knocked left, any other just hops in place)                                                  |                                                              |
| MYDx       | MY Direction        | Make you face direction X                                                                                                                               |                                                              |
| NCJx:y     | [NC?] Jump          | Jump to event Y if any entity of type X is present                                                                                                      |                                                              |
| NOD        | [?]                 | Text box wait for button press (used after MSG/MS2/MS3)                                                                                                 |                                                              |
| NUM0000    | [?]                 | [used to output Y from AM+ as text, not sure exactly what it is]                                                                                        |                                                              |
| PRI        | [?]                 | Hides status bars and freezes game action until KEY or END (used with MSG/MS2/MS3)                                                                      |                                                              |
| PS+x:y     | [?]                 | Set teleporter slot X to location Y                                                                                                                     |                                                              |
| QUAx       | QUAke               | Shake the screen for X ticks                                                                                                                            |                                                              |
| RMU        | Restore MUsic       | Restore music playback                                                                                                                                  |                                                              |
| SAT        | Speed-up All Text   | Instant text display on all messages until END (glitches scrolling text)                                                                                |                                                              |
| SILx       | Show ILlustration   | Show illustration during credits (use CIL after)                                                                                                        |                                                              |
| SK+x       | SKipflag +          | Set skipflag X (remains set until program exits, to avoid repeating cutscenes/dialogue after retrying)                                                  |                                                              |
| SK-x       | [SKipflag -?]       | @                                                                                                                                                       |                                                              |
| SKJx:y     | SKipflag Jump       | Jump to event Y if skipflag X is set                                                                                                                    |                                                              |
| SLP        | [?]                 | Teleporter location menu                                                                                                                                |                                                              |
| SMC        | Show My Character   | Restores main character entity (used after HMC)                                                                                                         |                                                              |
| SMPx:y     | [?]                 | [do something with entity X? - only used before and after the Omega fight]                                                                              |                                                              |
| SNPx:y:z:w | [S?] eNtity [P?]    | @                                                                                                                                                       | [create enemy/entity type X?] at coords Y:Z with direction W |
| SOUx       | SOUnd               | Play sound effect X                                                                                                                                     |                                                              |
| SPS        | Start Prop. Sound   | Start propeller sound (use CPS after) (from helicopter cutscene after final battles)                                                                    |                                                              |
| SSSx       | Start Stream Sound  | Start stream sound at pitch X (use CSS after) (from River area - normal pitch is 0400)                                                                  |                                                              |
| STC        | Save Time Counted   | Saves the current time to 290.rec                                                                                                                       |                                                              |
| SVP        | SaVe Profile        | Save game                                                                                                                                               |                                                              |
| TAMx:y:z   | Trade ArMs          | Trade weapon X for weapon Y, set max ammo to Z (max ammo 0000 = no change) (GLITCH: first weapon 0000)                                                  |                                                              |
| TRAx:y:z:w | TRAnsport           | Load map X, run event Y, transport you to coords Z:W                                                                                                    |                                                              |
| TUR        | [?]                 | Instant text display [until what? CLR?] (used after MSG/MS2/MS3)                                                                                        |                                                              |
| UNIx       | [?]                 | [0000 normal / 0001 zero-g movement, facing direction is locked (disables focus commands) (from Stream boss) / 0002 movement is locked, can still fire] |                                                              |
| WAIx       | WAIt                | Pause script for X ticks                                                                                                                                |                                                              |
| WAS        | WAit until Standing | Pause script until your character touches the ground                                                                                                    |                                                              |
| XX1x       | [?]                 | [shows distant view of island?]                                                                                                                         |                                                              |
| YNJx       | Yes/No Jump         | Ask yes or no, jump to event X if No                                                                                                                    |                                                              |
| ZAM        | Zero ArMs           | All weapons drop to level 1                                                                                                                             |                                                              |

** Otherwise text for message boxes?
* stage.tbl
** Guess (based on stage.dat from nx):
char num_stages,
{ char filename[32], stagename[35];
  uint8 tileset, background_no, scroll_type, boss_no,
         npc_set1, npc_set2;
}[num_stages]
** who knows?
* Map: .pxm
"PXM",char,uint16 xsize, uint16 ysize, char[xsize][ysize] tiles
* Tile Attribute: .pxa
char[256] tilecode
* Entity: .pxe
"PXE",char, uint32 num_entities,
{ uint16 x, y, id1, id2, type, flags }[num_entities]

;; id1 is a flag id; the object is created/not created if the
;; id is set in a global flags list by the tsc scripts.
;; Depends on appear-on-flagid and disappear-on-flagid

;; id2 is a unique identifier for the entity.

;; Flags for npcs
(defparameter *entity-flags*
(:solid-mushy 		#x0001)	; object blocks player but is a little "mushy" (normal solid state for enemies)
(:ignoretile44		#x0002)
(:invulnerable		#x0004)
(:ignore-solid		#x0008)
(:bouncy		#x0010)	; when solid-brick also set, acts like a mini trampoline
(:shootable		#x0020)
(:solid-brick		#x0040)	; object's entire bbox is rock-solid, just like a solid tile
(:noreartopattack	#x0080)
(:scriptontouch		#x0100)
(:scriptondeath		#x0200)
(:drop-powerups-dontuse	#x0400)	; not used here because it doesn't seem to be set on some npc.tbl entries which do in fact spawn powerups; see the nxflag which replaces it
(:appear-on-flagid	#x0800)
(:faces-right		#x1000)
(:scriptonactivate	#x2000)
(:disappear-on-flagid	#x4000)
(:show-floattext	#x8000))

* npc.tbl
uint16[361] default_flags, uint16[361] initial_hp,
uint8[361] spritesheet_num?, uint8[361] death_sound,
uint8[361] hurt_sound, uint8[361] smoke_amt_idx,
uint32[361] exp_for_kill, uint32[361] damage
* unknowns
** arms_level.tbl
** bullet.tbl
** credit.tsc : read somewhere it is different format
** csfont.fnt
** music.tbl
** pixtone.tbl
** wave.dat
** .org files
